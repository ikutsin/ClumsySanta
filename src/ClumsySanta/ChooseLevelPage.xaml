<Page
    x:Class="ClumsySanta.ChooseLevelPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewModel="clr-namespace:ClumsySanta.ViewModel"
    xmlns:controls1="clr-namespace:ClumsySanta.Controls"
    xmlns:snow="clr-namespace:ClumsySanta.Controls.Snow"
    mc:Ignorable="d" Background="Black">

    <Page.DataContext>
        <viewModel:ChooseLevelViewModel />
    </Page.DataContext>

    <Page.Resources>
        <DataTemplate x:Key="DataTemplate1">
            <Grid RenderTransformOrigin="0.5,0.5">
				<Grid.RenderTransform>
					<TransformGroup>
						<ScaleTransform/>
						<SkewTransform/>
						<RotateTransform/>
						<TranslateTransform Y="100"/>
					</TransformGroup>
				</Grid.RenderTransform>
				<Grid.RowDefinitions>
                    <RowDefinition/>
                    <RowDefinition Height="5"/>
                    <RowDefinition/>
                </Grid.RowDefinitions>
                <Image Source="{Binding LevelPickerImage, Mode=OneWay}" />
                
                <Image Source="{Binding LevelPickerImage, Mode=OneWay}" Grid.Row="2" RenderTransformOrigin="0.5,0.5">
                    <Image.OpacityMask>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Offset="0.5"/>
                            <GradientStop Offset="1" Color="#7F000000"/>
                        </LinearGradientBrush>
                    </Image.OpacityMask>
                    <Image.RenderTransform>
                        <TransformGroup>
                            <ScaleTransform ScaleY="-1"/>
                            <!--
                            <SkewTransform AngleX="0" AngleY="0"/>
                            <RotateTransform Angle="0"/>
                            -->
                            <TranslateTransform/>
                        </TransformGroup>
                    </Image.RenderTransform>
                </Image>
                <TextBlock HorizontalAlignment="Center" Style="{StaticResource ChooseLevelText}" Text="{Binding Name}" />
            </Grid>
        </DataTemplate>
        <ItemsPanelTemplate x:Key="ItemsPanelTemplate1">
            <controls1:CollectionFlowPanel ItemHeight="350" ItemWidth="350" FocusedItemOffset="120" UnfocusedItemOffset="20" ItemVisibility="5" RenderTransformOrigin="0.5,0.5"/>
        </ItemsPanelTemplate>
    </Page.Resources>

    <!--LayoutRoot is the root grid where all page content is placed-->
    
    <Grid x:Name="LayoutRoot" >
        
        <snow:SnowFlakes FlakeImageSource="Assets/GameEngine/snowflake.png"
                             Opacity=".5" Grid.RowSpan="2" />
        <Image Margin="60,20"
            VerticalAlignment="Top"
               MaxHeight="150"
            Source="Assets/logo.png"></Image>
        <Grid Margin="0,20,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <controls1:CollectionFlow x:Name="LevelsCoverFlow" ItemsSource="{Binding Levels}" 
             ItemTemplate="{StaticResource DataTemplate1}" ItemsPanel="{StaticResource ItemsPanelTemplate1}" Grid.ColumnSpan="2" >

            </controls1:CollectionFlow>

            <Image Source="Assets/Common/back.png" Width="60" Height="60" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="20,224,0,224" MouseLeftButtonDown="CoverflowLeft"/>
            <Image Source="Assets/Common/next.png" Width="60" Height="60" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,224,20,224" MouseLeftButtonDown="CoverflowRight" Grid.Column="1" />
        </Grid>
        <Button VerticalAlignment="Bottom" Style="{StaticResource MyButton}" Content="Start" 
                    Click="Start_OnClick"/>
        
        <!--
        <Button VerticalAlignment="Bottom" Style="{StaticResource MyButton}" Content="Start" 
                    Command="{Binding DoStartGame}"
                    CommandParameter="{Binding ElementName=LevelsCoverFlow, Path=SelectedItem}"/>
        -->
        </Grid>
    
</Page>
