<Page
    x:Class="ClumsySanta.GamePlayEngine2"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewModel="clr-namespace:ClumsySanta.ViewModel"
    xmlns:findAPresents="clr-namespace:ClumsySanta"
    mc:Ignorable="d">

	<Page.DataContext>
		<viewModel:GamePlayEngineViewModel />
	</Page.DataContext>

	<!--LayoutRoot is the root grid where all page content is placed-->
	<Viewbox>
		<Grid Margin="0" >

			<ScrollViewer  
		    Loaded="ScrollView_OnLoaded" x:Name="Scroller"
		    HorizontalScrollBarVisibility="Hidden"
		    VerticalScrollBarVisibility="Hidden">

				<!--http://msdn.microsoft.com/en-us/library/windowsphone/develop/ff967560(v=vs.105).aspx-->
				<!--http://wp8beginner.blogspot.com/2013/03/pinch-to-zoom-within-scrollviewer.html-->
				<!--https://github.com/sebastienjouhans/c-sharp-scrollviewer-snap-control/blob/master/Kinrou.Controls.ScrollViewerWithSnap.WP8/ScrollViewerWithSnap.xaml.cs-->
				<Canvas x:Name="MainCanvas" Width="{Binding LevelModel.BgImgSize.Width}" Height="{Binding LevelModel.BgImgSize.Height}">
					<!--<Canvas.Background>
                    <ImageBrush 
                        Stretch="Fill" AlignmentX="Right"
                        ImageSource="{Binding LevelModel.BackgroundImage}" />
                </Canvas.Background>-->

					<Image Stretch="None" Canvas.ZIndex="-100" Source="{Binding LevelModel.BackgroundImage}" />
					<Image Canvas.Left="2000" Canvas.ZIndex="-99" x:Name="LaterBackgroundImage" Stretch="None" Source="{Binding LevelModel.LaterBackgroundImage}" />

					<Canvas Canvas.Left="0" x:Name="FirstDecorationsCanvas" />
					<Canvas Canvas.Left="2000" x:Name="FirstLaterDecorationsCanvas" />
					<Canvas Canvas.Left="0" x:Name="PresentsCanvas" />
					<Canvas Canvas.Left="2000" x:Name="LaterPresentsCanvas" />
					<Canvas Canvas.Left="0" x:Name="DecorationsCanvas" />
					<Canvas Canvas.Left="2000" x:Name="LaterDecorationsCanvas" />
				</Canvas>


				<!--<controls:LayoutTransformer x:Name="ZoomTransformer">
                <controls:LayoutTransformer.LayoutTransform>
                    <TransformGroup>
                        <ScaleTransform x:Name="MainCanvasTransform"
                                        ScaleX=".5" ScaleY="2"/>
                    </TransformGroup>
                </controls:LayoutTransformer.LayoutTransform>
                <controls:LayoutTransformer.Content>
                    <Canvas>
                        <Image Source="{Binding LevelModel.BackgroundImage}" />
                        <Canvas x:Name="PresentsCanvas" />
                        <Canvas x:Name="DecorationsCanvas" />
                    </Canvas>
                </controls:LayoutTransformer.Content>
            </controls:LayoutTransformer>-->

			</ScrollViewer>

			<findAPresents:LevelTimer Timeout="OnLevelCompleted" TicksLeft="{Binding LevelModel.PlaybackTime.TotalSeconds}" Margin="0 20 60 0" Width="55" Icon="Assets/alarm.png" VerticalAlignment="Top" HorizontalAlignment="Right" x:Name="LevelTimer" />
			<findAPresents:PresentsCounter Margin="0 20 0 0" 
            PresentsToWait="{Binding LevelModel.PresentsToShow}" 
            AllPresentsCollected="OnLevelCompleted" PresentIcon="{Binding LevelModel.TimerPresentIcon}" x:Name="PresentsCounter" />
		</Grid>
	</Viewbox>
</Page>
